---
// import { Image } from "astro:assets";
import Layout from "../../../../layouts/Layout.astro";
import { contentfulClient } from "../../../../lib/contentful";
import slugify from "../../../../lib/createSlug";
import Card from "../../../../components/Card.astro";
import PlaceholderImage from "@/components/ImageLightbox/PlaceholderImage.astro";

export async function getStaticPaths() {
    const allPosts = await contentfulClient.getEntries({
        content_type: "works",
    });
    return allPosts.items.map((item: any) => {
        return {
            params: {
                album: slugify(item.fields.AlbumCategory.fields.slug),
                galeria: slugify(item.fields.slug),
            },
            props: {
                data: item,
            },
        };
    });
}

const AlbumsCategorias = await contentfulClient.getEntries({
    content_type: "AlbumsCategorias",
});

const allCategory = AlbumsCategorias.items.sort(function (a: any, b: any) {
    if (a.fields.slug < b.fields.slug) {
        return -1;
    }
    if (a.fields.slug > b.fields.slug) {
        return 1;
    }
    return 0;
});

const { data } = Astro.props;
---

<Layout title={data.fields.title}>
    <div
        class="h-screen overflow-hidden w-full bg-white relative grid grid-cols-2 justify-center items-center mb-6"
    >
        <h1
            style="text-wrap: balance;"
            class="animate__animated animate__fadeIn text-yellow-400/60 max-w-3xl mx-auto text-center z-10 relative mb-12 text-6xl"
        >
            {data.fields.title}
        </h1>
        <img
            src={`https:${data.fields.featuredImg.fields.file.url}?w=1600&h=980&fm=png&q=90`}
            class="opacity-100 z-0 h-screen w-full object-cover"
            alt={data.fields.title}
        />
    </div>
    <div class="max-w-6xl mx-auto">
        <div class="">
            {
                data.fields.imagesWorks.map((item: any) => (
                    <div class="relative mb-24">
                        <img
                            src={`https:${item.fields.file.url}?w=1200&h=1200&fm=png&q=90`}
                            width="1600"
                            alt={data.fields.title}
                            height="1600"
                            class="z-10 relative object-cover glightbox w-full animate__animated animate__fadeIn"
                        />
                    </div>
                ))
            }
        </div>
        <!--
        <div class="mt-24">
          <h2 class="text-3xl mb-6">Galería Fotográfica</h2>
          <div class="grid md:grid-cols-4 gap-4 ">
            {
              allCategory.map((item: any) => (
                <div class="mb-3">
                  <Card
                    title={item.fields.title}
                    image={item.fields.featuredImg.fields.file.url}
                    link={`/albums/${item.fields.slug}`}
                  />
                </div>
              ))
            }
          </div>
        </div>
        -->
    </div>
</Layout>
